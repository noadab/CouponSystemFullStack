{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\noada\\\\eclipse-workspace\\\\CouponSystemSpring\\\\src\\\\main\\\\react\\\\src\\\\components\\\\Coupon\\\\CouponFetch.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useCallback, useEffect } from 'react';\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { authActions } from \"../../store/auth\";\nimport CouponList from './CouponList';\nimport CouponsFilter from './CouponsFilter';\nimport classes from './CouponList.module.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst CouponFetch = () => {\n  _s();\n\n  const userType = useSelector(state => state.auth.userType);\n  const token = useSelector(state => state.auth.token);\n  const dispatch = useDispatch();\n  const [coupons, setCoupons] = useState([]);\n  const [isCouponsFetch, setIsCouponsFetch] = useState(false);\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState(null);\n  const fetchCouponsHandler = useCallback(async event => {\n    setIsLoading(true);\n    setError(null);\n    let response;\n\n    try {\n      if (event.value != \"No filter\") {\n        response = await fetchWrapper.get(\"/\" + userType + \"/all\" + event.type + \"/\" + event.value + \"/\" + token);\n      } else {\n        response = await fetch(\"/\" + userType + \"/all/\" + token);\n        console.log(response);\n      }\n\n      if (response.statusText === \"Not Found\") {\n        setError(await response.text());\n        console.log(error);\n      } else if (!response.ok) {\n        window.alert(\"Session timeout!\");\n        setError(await response.text());\n        dispatch(authActions.logout());\n        throw new Error(\"Something went wrong!\");\n      } else {\n        console.log(\"Response Okay!\");\n        const data = await response.json();\n        const transformedCoupons = data.map(couponData => {\n          return {\n            id: couponData.id,\n            title: couponData.title,\n            category: couponData.category,\n            description: couponData.description,\n            startDate: couponData.startDate,\n            endDate: couponData.endDate,\n            amount: couponData.amount,\n            price: couponData.price,\n            image: couponData.image\n          };\n        });\n        setCoupons(transformedCoupons);\n      }\n    } catch (error) {\n      setError(error.message);\n    }\n\n    setIsCouponsFetch(true);\n    setIsLoading(false);\n  }, []);\n  useEffect(() => {\n    fetchCouponsHandler({\n      value: '',\n      type: ''\n    });\n  }, []);\n\n  let content = /*#__PURE__*/_jsxDEV(\"section\", {\n    children: \"Found no coupons.\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 73,\n    columnNumber: 17\n  }, this);\n\n  if (coupons.length > 0) {\n    content = /*#__PURE__*/_jsxDEV(CouponList, {\n      coupons: coupons\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 15\n    }, this);\n  }\n\n  if (error) {\n    content = /*#__PURE__*/_jsxDEV(\"section\", {\n      children: error\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 15\n    }, this);\n  }\n\n  if (isLoading) {\n    content = /*#__PURE__*/_jsxDEV(\"section\", {\n      children: \"Loading...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 15\n    }, this);\n  }\n\n  if (!isCouponsFetch) {\n    content = null;\n  }\n\n  const closeCouponsListHandler = () => {\n    setIsCouponsFetch(false);\n  };\n\n  const openCouponsListHandler = () => {\n    fetchCouponsHandler({\n      value: '',\n      type: ''\n    });\n    setIsCouponsFetch(true);\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [isCouponsFetch && /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: closeCouponsListHandler,\n      children: \"Close coupons\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 26\n    }, this), isCouponsFetch && /*#__PURE__*/_jsxDEV(CouponsFilter, {\n      onFilter: fetchCouponsHandler\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 26\n    }, this), !isCouponsFetch && /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: openCouponsListHandler,\n      children: \"Fetch coupons\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 27\n    }, this), content != null && /*#__PURE__*/_jsxDEV(\"div\", {\n      children: content\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 27\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 100,\n    columnNumber: 5\n  }, this);\n};\n\n_s(CouponFetch, \"v8LBn+8ezk6iLUJ0ptF8TC++jhM=\", false, function () {\n  return [useSelector, useSelector, useDispatch];\n});\n\n_c = CouponFetch;\nexport default CouponFetch;\n\nvar _c;\n\n$RefreshReg$(_c, \"CouponFetch\");","map":{"version":3,"sources":["C:/Users/noada/eclipse-workspace/CouponSystemSpring/src/main/react/src/components/Coupon/CouponFetch.js"],"names":["React","useState","useCallback","useEffect","useDispatch","useSelector","authActions","CouponList","CouponsFilter","classes","CouponFetch","userType","state","auth","token","dispatch","coupons","setCoupons","isCouponsFetch","setIsCouponsFetch","isLoading","setIsLoading","error","setError","fetchCouponsHandler","event","response","value","fetchWrapper","get","type","fetch","console","log","statusText","text","ok","window","alert","logout","Error","data","json","transformedCoupons","map","couponData","id","title","category","description","startDate","endDate","amount","price","image","message","content","length","closeCouponsListHandler","openCouponsListHandler"],"mappings":"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","sourcesContent":["import React, { useState, useCallback, useEffect } from 'react';\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { authActions } from \"../../store/auth\";\r\n\r\nimport CouponList from './CouponList'\r\nimport CouponsFilter from './CouponsFilter'\r\nimport classes from './CouponList.module.css'\r\n\r\nconst CouponFetch = () => {\r\n\r\n  const userType = useSelector(state => state.auth.userType);\r\n  const token = useSelector(state => state.auth.token);\r\n  const dispatch = useDispatch();\r\n\r\n  const [coupons, setCoupons] = useState([]);\r\n  const [isCouponsFetch, setIsCouponsFetch] = useState(false);\r\n\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [error, setError] = useState(null);\r\n\r\n  const fetchCouponsHandler = useCallback(async (event) => {\r\n    setIsLoading(true);\r\n    setError(null);\r\n    let response;\r\n    try {\r\n      if ((event.value) != (\"No filter\")) {\r\n        response = await fetchWrapper.get(\"/\" + userType + \"/all\" + event.type + \"/\" + event.value + \"/\" + token);\r\n      }\r\n      else {\r\n        response = await fetch(\"/\" + userType + \"/all/\" + token);\r\n        console.log(response)\r\n      }\r\n\r\n      if (response.statusText === \"Not Found\") {\r\n        setError(await response.text());\r\n        console.log(error)\r\n      }\r\n      else if (!response.ok) {\r\n        window.alert(\"Session timeout!\");\r\n        setError(await response.text());\r\n        dispatch(authActions.logout());\r\n        throw new Error(\"Something went wrong!\");\r\n      }\r\n      else {\r\n        console.log(\"Response Okay!\");\r\n        const data = await response.json();\r\n        const transformedCoupons = data.map((couponData) => {\r\n          return {\r\n            id: couponData.id,\r\n            title: couponData.title,\r\n            category: couponData.category,\r\n            description: couponData.description,\r\n            startDate: couponData.startDate,\r\n            endDate: couponData.endDate,\r\n            amount: couponData.amount,\r\n            price: couponData.price,\r\n            image: couponData.image\r\n          };\r\n        });\r\n        setCoupons(transformedCoupons);\r\n      }\r\n    } catch (error) {\r\n      setError(error.message);\r\n    }\r\n    setIsCouponsFetch(true);\r\n    setIsLoading(false);\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    fetchCouponsHandler({value:'',type:''});\r\n  }, []);\r\n\r\n  let content = <section>Found no coupons.</section>;\r\n\r\n  if (coupons.length > 0) {\r\n    content = <CouponList coupons={coupons} />;\r\n  }\r\n\r\n  if (error) {\r\n    content = <section>{error}</section>;\r\n  }\r\n\r\n  if (isLoading) {\r\n    content = <section>Loading...</section>;\r\n  }\r\n\r\n  if (!isCouponsFetch) {\r\n    content = null;\r\n  }\r\n\r\n  const closeCouponsListHandler = () => {\r\n    setIsCouponsFetch(false);\r\n  }\r\n  const openCouponsListHandler = ()=> {\r\n    fetchCouponsHandler({value:'',type:''});\r\n    setIsCouponsFetch(true);\r\n  }\r\n\r\n  return (\r\n    <div >\r\n      {isCouponsFetch && <button onClick={closeCouponsListHandler} >Close coupons</button>}\r\n      {isCouponsFetch && <CouponsFilter onFilter={fetchCouponsHandler} />}\r\n      {!isCouponsFetch && <button onClick={openCouponsListHandler}>Fetch coupons</button>}\r\n      {content != null && <div>{content}</div>}\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default CouponFetch;"]},"metadata":{},"sourceType":"module"}