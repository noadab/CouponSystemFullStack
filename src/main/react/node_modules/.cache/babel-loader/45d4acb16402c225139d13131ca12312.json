{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\noada\\\\eclipse-workspace\\\\CouponSystemSpring\\\\src\\\\main\\\\react\\\\src\\\\components\\\\Coupon\\\\Coupon.js\",\n    _s = $RefreshSig$();\n\nimport React, { useCallback, useState } from 'react';\nimport { useSelector } from \"react-redux\";\nimport { useHistory } from \"react-router-dom\";\nimport fetchWrapper from '../../helper/fetchWrapper';\nimport classes from './Coupon.module.css';\nimport Card from '../../UI/card/Card';\nimport CardCoupon from '../../UI/CardCoupon';\nimport UpdateCoupon from './UpdateCoupon';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst Coupon = props => {\n  _s();\n\n  const token = useSelector(state => state.auth.token);\n  const userType = useSelector(state => state.auth.userType);\n  const isAuth = useSelector(state => state.auth.isAuth);\n  const history = useHistory();\n  const id = props.id;\n  const viewCall = props.view;\n  const [coupon, setCoupon] = useState(props);\n  const [availCoupon, setAvailCoupon] = useState(true);\n  const [edit, setEdit] = useState(false);\n\n  let viewCoupon = /*#__PURE__*/_jsxDEV(CardCoupon, {\n    card: coupon\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 29,\n    columnNumber: 20\n  }, this);\n\n  const deleteCoupon = useCallback(async event => {\n    event.preventDefault();\n    let method = \"DELETE\";\n    let path = \"/company/delete/\" + id;\n\n    try {\n      const data = await fetchWrapper.delete(method, path, token, () => {\n        console.log(data.text());\n      });\n      setAvailCoupon(false);\n    } // try {\n    //   const response = await fetch(\"/company/delete/\" + id, requestOptions);\n    //   const text = await response.text();\n    //   if (!response.ok) {\n    //     window.alert(text);\n    //     //dispatch(authActions.logout());\n    //     throw new Error(\"Something went wrong!\");\n    //   }\n    //   console.log(\"Response Okay!\");\n    //   console.log(text);\n    catch (error) {\n      console.log(error.message);\n    }\n  }, []);\n\n  const deleteCouponChangeHandler = event => {\n    if (window.confirm(\"are you sure you want to delete this coupon?\")) {\n      deleteCoupon(event);\n    }\n  };\n\n  const purchaseCouponChangeHandler = () => {\n    if (userType === \"customer\") {\n      if (window.confirm(\"Do you wan't to buy this coupon?\")) {\n        onPurchase();\n      }\n    } else if ({\n      isAuth\n    }) {\n      alert(userType + \" user can't purchase coupons\");\n    } else {\n      if (window.confirm(\"You can't purchase this coupon beacuse you are logout, do you wan't to login?\")) {\n        history.push(\"/login\");\n      }\n    }\n  };\n\n  const updateCouponChangeHandler = () => {\n    setEdit(true);\n  };\n\n  const onCancel = () => {\n    setEdit(false);\n  };\n\n  const onSave = props => {\n    setEdit(false);\n    setCoupon(props);\n  };\n\n  const onPurchase = useCallback(async () => {\n    let couponToSend = coupon;\n    let method = \"PUT\";\n    let path = userType + \"/purchasesCoupon\";\n\n    try {\n      const data = await fetchWrapper.fetch(method, path, couponToSend, token, () => {\n        console.log(\"error\");\n      });\n      alert(\"Enjoy your new coupon! \");\n    } catch (error) {\n      console.log(error.message);\n    }\n  }, []);\n\n  if (edit) {\n    viewCoupon = /*#__PURE__*/_jsxDEV(UpdateCoupon, {\n      coupon: coupon,\n      onCancel: onCancel,\n      onSave: onSave\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 18\n    }, this);\n  }\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: availCoupon && /*#__PURE__*/_jsxDEV(Card, {\n      className: classes.coupon,\n      children: [viewCoupon, viewCall != \"home\" && userType === \"company\" && !edit && /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: deleteCouponChangeHandler,\n        children: \"Delete coupon\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 121,\n        columnNumber: 11\n      }, this), viewCall != \"home\" && userType === \"company\" && !edit && /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: updateCouponChangeHandler,\n        children: \"Update coupon\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 123,\n        columnNumber: 11\n      }, this), viewCall === \"home\" && /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: purchaseCouponChangeHandler,\n        children: \"BUY COUPUN\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 125,\n        columnNumber: 31\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 116,\n    columnNumber: 5\n  }, this);\n};\n\n_s(Coupon, \"Fszvfcj3C6K0nY3m1IrRWuSMJPw=\", false, function () {\n  return [useSelector, useSelector, useSelector, useHistory];\n});\n\n_c = Coupon;\nexport default Coupon;\n\nvar _c;\n\n$RefreshReg$(_c, \"Coupon\");","map":{"version":3,"sources":["C:/Users/noada/eclipse-workspace/CouponSystemSpring/src/main/react/src/components/Coupon/Coupon.js"],"names":["React","useCallback","useState","useSelector","useHistory","fetchWrapper","classes","Card","CardCoupon","UpdateCoupon","Coupon","props","token","state","auth","userType","isAuth","history","id","viewCall","view","coupon","setCoupon","availCoupon","setAvailCoupon","edit","setEdit","viewCoupon","deleteCoupon","event","preventDefault","method","path","data","delete","console","log","text","error","message","deleteCouponChangeHandler","window","confirm","purchaseCouponChangeHandler","onPurchase","alert","push","updateCouponChangeHandler","onCancel","onSave","couponToSend","fetch"],"mappings":"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","sourcesContent":["import React, { useCallback, useState } from 'react';\r\nimport { useSelector } from \"react-redux\";\r\nimport { useHistory } from \"react-router-dom\";\r\n\r\nimport fetchWrapper from '../../helper/fetchWrapper'\r\nimport classes from './Coupon.module.css';\r\nimport Card from '../../UI/card/Card';\r\nimport CardCoupon from '../../UI/CardCoupon'\r\nimport UpdateCoupon from './UpdateCoupon'\r\n\r\n\r\n\r\nconst Coupon = (props) => {\r\n\r\n  const token = useSelector((state) => state.auth.token);\r\n  const userType = useSelector((state) => state.auth.userType);\r\n  const isAuth = useSelector((state) => state.auth.isAuth);\r\n  \r\n  const history = useHistory();\r\n\r\n  const id = props.id;\r\n  const viewCall= props.view;\r\n  \r\n  const [coupon, setCoupon]= useState(props);\r\n  const [availCoupon, setAvailCoupon] = useState(true);\r\n  const [edit, setEdit] = useState(false);\r\n\r\n  \r\n  let viewCoupon = <CardCoupon card={coupon} />\r\n\r\n  const deleteCoupon = useCallback(async (event) => {\r\n    event.preventDefault();\r\n\r\n    let method = \"DELETE\";\r\n    let path =\"/company/delete/\" + id;\r\n    try {\r\n      const data = await fetchWrapper.delete(method, path, token, () => {\r\n      console.log(data.text());\r\n    })\r\n  \r\n      setAvailCoupon(false);}\r\n    \r\n    // try {\r\n    //   const response = await fetch(\"/company/delete/\" + id, requestOptions);\r\n    //   const text = await response.text();\r\n    //   if (!response.ok) {\r\n    //     window.alert(text);\r\n    //     //dispatch(authActions.logout());\r\n    //     throw new Error(\"Something went wrong!\");\r\n    //   }\r\n    //   console.log(\"Response Okay!\");\r\n    //   console.log(text);\r\n     catch (error) {\r\n      console.log(error.message);\r\n    }\r\n  }, []);\r\n\r\n  const deleteCouponChangeHandler = (event) => {\r\n    if (window.confirm(\"are you sure you want to delete this coupon?\")) {\r\n      deleteCoupon(event);\r\n    }\r\n  }\r\n\r\n\r\n  const purchaseCouponChangeHandler = () => {\r\n    if (userType===\"customer\"){\r\n      if (window.confirm(\"Do you wan't to buy this coupon?\")) {\r\n        onPurchase();\r\n      }\r\n\r\n    }\r\n    else if ({isAuth}){\r\n      alert( userType+\" user can't purchase coupons\")\r\n    }\r\n    else {\r\n      if (window.confirm(\"You can't purchase this coupon beacuse you are logout, do you wan't to login?\")) {\r\n        history.push(\"/login\");\r\n      }\r\n    }\r\n  }\r\n\r\n  const updateCouponChangeHandler = () => {\r\n    setEdit(true)\r\n    \r\n  }\r\n\r\n  const onCancel = () => {\r\n    setEdit(false)\r\n  }\r\n\r\n  const onSave = (props)=>{\r\n    setEdit(false)\r\n    setCoupon(props)\r\n  }\r\n\r\n  const onPurchase=  useCallback(async () => {\r\n        let couponToSend = coupon;\r\n        let method = \"PUT\"\r\n        let path = userType + \"/purchasesCoupon\"\r\n        try {\r\n            const data = await fetchWrapper.fetch(method, path, couponToSend, token, () => {\r\n                console.log(\"error\");\r\n            })\r\n            alert(\"Enjoy your new coupon! \");\r\n        } catch (error) {\r\n            console.log(error.message);\r\n        }\r\n  }, [])\r\n  \r\n  \r\n  if (edit) {\r\n    viewCoupon = <UpdateCoupon coupon={coupon} onCancel={onCancel} onSave={onSave} ></UpdateCoupon>\r\n  }\r\n\r\n  return (\r\n    <div >\r\n      {availCoupon && \r\n      <Card className={classes.coupon}>\r\n        {viewCoupon}\r\n        {viewCall!=\"home\" && userType === \"company\" && !edit &&\r\n          <button onClick={deleteCouponChangeHandler}>Delete coupon</button>}\r\n        {viewCall!=\"home\" && userType === \"company\" && !edit &&\r\n          <button onClick={updateCouponChangeHandler}>Update coupon</button>}\r\n        \r\n        {viewCall===\"home\" && <button onClick={purchaseCouponChangeHandler} >BUY COUPUN</button>}\r\n      </Card>}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Coupon;"]},"metadata":{},"sourceType":"module"}